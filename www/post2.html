<!DOCTYPE html>
<html>
<head>
<title>Roadkill Report</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="./css/jquery.mobile-1.4.3.css">
<script src="./js/jquery-1.11.1.min.js"></script>
<script src="./js/jquery.mobile-1.4.3.js"></script>
<link rel="stylesheet" media="screen" href="./assets/css/home.css">
<link rel="stylesheet" media="all" href="./assets/css/application.css">
<script src="./assets/js/application.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBGDh15D3BS6rNUFly2WXYp4vMue7IQURU&sensor=false&language=zh-TW"></script>
<script type="text/javascript" src="https://maps.gstatic.com/intl/zh_tw/mapfiles/api-3/17/8/main.js"></script>
<script src="./assets/js/binaryajax.js"></script>
<script src="./assets/js/exif.js"></script>
<link rel="stylesheet" media="screen" href="./assets/css/jtsage/jqm-datebox-1.4.2.css">
<script src="./assets/js/jtsage/jqm-datebox-1.4.2.core.js"></script>
<script src="./assets/js/jtsage/jqm-datebox-1.4.2.mode.calbox.js"></script>
<script src="./assets/js/jtsage/jqm-datebox-1.4.2.mode.datebox.js"></script>
<script src="./assets/js/jtsage/jquery.mobile.datebox.i18n.zh-TW.utf8.js"></script>
<script src="./js/jquery.cookie.js"></script>
<script src="./js/tool.js"></script>
<script src="cordova.js"></script>
<script src="./assets/js/home.js"></script>
</head>

<body>

<div id="home" data-role="page">
    <div data-role="main" class="ui-content" data-theme="a">
        <ul data-role="listview" data-split-theme="a" data-inset="true" >
            <li id="eventRow" data-icon="edit">
                <a href="#" data-rel="popup" data-position-to="window" data-transition="fade">
                    <img src="./assets/img/camera.png" id="photo" class="minor-padding vcenter photo" alt="照片">
                    <textarea id="photoDesc" class="simple-border photoDesc" placeholder="照片說明"></textarea>
                    <div><p class="location"></p></div>
                </a>
                <a id="btnEdit" href="#" class="btnEdit" data-rel="popup" data-position-to="window" data-transition="pop">編輯</a>
                <div style="width: 0; height: 0; overflow: hidden;">
                    <input id="photoPicker" class="photoPicker" type="file" accept="image/*" capture="camera">
                </div>
            </li>
        </ul>   
        <div id="bottomContainer">
            <button id="drupalBtn" class="btn btn-block" onclick="loginDrupal()">Login to drupal</button>
        </div>
    </div>
    
    <div id="homeToolbar" data-role="footer" data-position="fixed" data-tap-toggle="false" style="padding: 5px 0 5px 0">
        <div class="text-center" style="margin: 0 50% 0 50%;">
            <a id="btnUpload" href="#" class="ui-btn ui-btn-a ui-btn-inline ui-corner-all ui-shadow rounded-corner pastel-blue" style="padding: 20px 50px 20px 50px; margin: 0 -64px;">上傳</a>
        </div>
    </div>
    
    <!-- popups -->
    
    <div id="editPopup" data-role="popup" data-theme="a" data-overlay-theme="b" class="ui-content" style="max-width:340px; padding: 35px;">
        <p style="text-align: center" >對這個事件，你要...</p>
            <ul data-role="listview" data-inset="true">
                <li><a id="btnRetakePhoto" href="#">重拍一張照片</a></li>
                <li><a id="btnUpdateLocation" href="#">標記日期與地點</a></li>
            </ul>
    </div>
    <div id="imgPopup" data-role="popup" data-theme="a" data-overlay-theme="b" class="ui-content" style="max-width:340px; padding: 35px;">
            <ul data-role="listview" data-inset="true">
                <li><a id="btnCapturePhoto" href="#">拍攝新的照片</a></li>
                <li><a id="btnGetPhoto" href="#">從相簿中選取</a></li>
            </ul>
    </div>

</div>

<div id="map" data-role="page">
    <div data-role="main" class="ui-content" data-theme="a" style="padding:0;">
        <div id="gmapCanvas" style="width:100%;"></div>
    </div>
    <div id="mapToolbar" data-role="footer" data-position="fixed" data-tap-toggle="false" style="padding: 5px 0 5px 0">
        <div><p id="selectedMapLocation" class="text-center"></p></div>
        <div><p id="selectedDate" class="text-center"></p></div>
        <div style="display: none;">
            <input id="datePicker" type="date" data-role="datebox" data-options='{"mode": "calbox", "overrideDateFormat": "%Y/%m/%d", "beforeToday": true}'>
        </div>
        <div class="text-center" data-role="controlgroup" data-type="horizontal" style="padding: 10px 0 10px 0;">
            <a id="btnConfirmLocation" href="#" class="ui-btn ui-corner-all ui-btn-icon-bottom ui-icon-check horizontal-controlgroup-large">確定</a>
            <a id="btnPickDateTime" href="#" class="ui-btn ui-corner-all ui-btn-icon-bottom ui-icon-calendar horizontal-controlgroup-large">日期</a>
            <a id="btnCancelMapView" href="#" class="ui-btn ui-corner-all ui-btn-icon-bottom ui-icon-delete horizontal-controlgroup-large">取消</a>
        </div>
    </div>
</div>

<script>
    // A button will call this function
    /*
    function getPhoto(source) {
        // Retrieve image file location from specified source
        navigator.camera.getPicture(
            onPhotoDataSuccess,
            onFail,{
                quality: 50,
                //destinationType: destinationType.FILE_URI,
                destinationType: destinationType.DATA_URL,
                sourceType: source
        });
    }

    // Called if something bad happens.
    //
    function onFail(message) {
      alert('Failed because: ' + message);
    }*/

    function triggerDrupalBtn(turn){
        if(turn){
            $('#drupalBtn').html('Logout drupal');
            $('#drupalBtn').attr('onclick', 'logoutDrupal()');
        }else{
            $('#drupalBtn').html('Login drupal');
            $('#drupalBtn').attr('onclick', 'loginDrupal()');
        }
    }

    function loginDrupal(){
        loginToDrupal({"hello":"pica"}, function(result){
            if(result === "success"){
                alert(result);
                triggerDrupalBtn(true);
            }
        });
    }
    function logoutDrupal(){
        logoutToDrupal(function(result){
            alert(result);
            triggerDrupalBtn(false);
        });
    }
    
</script>

</body>
</html>

